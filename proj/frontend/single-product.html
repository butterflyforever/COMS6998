<!doctype html>
<html lang="en">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="icon" href="img/favicon.png" type="image/png">
	<title>Item Details</title>
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" href="vendors/linericon/style.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="vendors/owl-carousel/owl.carousel.min.css">
	<link rel="stylesheet" href="vendors/lightbox/simpleLightbox.css">
	<link rel="stylesheet" href="vendors/nice-select/css/nice-select.css">
	<link rel="stylesheet" href="vendors/animate-css/animate.css">
	<link rel="stylesheet" href="vendors/jquery-ui/jquery-ui.css">
	<!-- main css -->
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/responsive.css">

</head>

<body>

	<!--================Header Menu Area =================-->
	<!--================Header Menu Area =================-->


	<!--================Home Banner Area =================-->
	<section class="banner_area">
		<div class="banner_inner d-flex align-items-center">
			<div class="container">
				<div class="banner_content text-center">
					<h2>Item Details</h2>
					<div class="page_link">
						<a href="index.html">Home</a>
						<!-- <a href="category.html">Category</a> -->
						<a href="#">Item Details</a>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!--================End Home Banner Area =================-->

	<!--================Single Product Area =================-->
	<div class="product_image_area">
		<div class="container">
			<div class="row s_product_inner">
				<div class="col-lg-6">
					<div class="s_product_img">
						<div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
							
							<ol class="carousel-indicators" id="carousel-ind">
								<!-- <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active">
									<img src="img/product/single-product/s-product-s-2.jpg" width="60" height="60">
								</li>
								<li data-target="#carouselExampleIndicators" data-slide-to="1">
									<img src="img/product/single-product/s-product-s-3.jpg">
								</li>
								<li data-target="#carouselExampleIndicators" data-slide-to="2">
									<img src="img/product/single-product/s-product-s-4.jpg">
								</li> -->
							</ol>
							
							<div class="carousel-inner" id="carousel-inn">
								<!-- <div class="carousel-item active">
									<img class="d-block w-100" src="img/product/single-product/s-product-1.jpg">
								</div>
								<div class="carousel-item">
									<img class="d-block w-100" src="img/product/single-product/s-product-1.jpg">
								</div>
								<div class="carousel-item">
									<img class="d-block w-100" src="img/product/single-product/s-product-1.jpg">
								</div> -->
							</div>
							
						</div>
					</div>
				</div>
				<div class="col-lg-5 offset-lg-1">
					<div class="s_product_text">
						<h3 id="item-title"></h3>
						<h4><font color="grey"><strike>$<span id=prvprice></span></strike></font></h4>							
						<h2>$<span id=pricenum></span></h2>
						<ul class="list">
							<li>
								<!-- <a class="active" href="#"><span>Category</span> : Household</a> -->
								<a class="active">
									<span>Category</span> : 
								</a>
								<container id="category"></container>
							</li>
							<li>
								<!-- <a class="active" href="#"><span>Category</span> : Household</a> -->
								<a class="active">
									<span>Tags</span> : 
								</a>
								<container id="tag"></container>
							</li>
							<li>
								<a href="#">
									<span>Availibility</span> : <span id=availability></span></a>
							</li>
						</ul>
						<p id="item-description"></p>
						<!-- <p>Mill Oil is an innovative oil filled radiator with the most modern technology. If you are looking for something that
							can make your interior look awesome, and at the same time give you the pleasant warm feeling during the winter.</p> -->
						<!-- <div class="product_count">
							<label for="qty">Quantity:</label>
							<input type="text" name="qty" id="sst" maxlength="12" value="1" title="Quantity:" class="input-text qty">
							<button onclick="var result = document.getElementById('sst'); var sst = result.value; if( !isNaN( sst )) result.value++;return false;"
							 class="increase items-count" type="button">
								<i class="lnr lnr-chevron-up"></i>
							</button>
							<button onclick="var result = document.getElementById('sst'); var sst = result.value; if( !isNaN( sst ) &amp;&amp; sst > 0 ) result.value--;return false;"
							 class="reduced items-count" type="button">
								<i class="lnr lnr-chevron-down"></i>
							</button>
						</div> -->
						<div class="card_area">
							<a class="main_btn" onclick="addCart()"><font color='white'>Add to Cart</font></a>
							<!-- <a class="icon_btn" href="#">
								<i class="lnr lnr lnr-diamond"></i>
							</a>
							<a class="icon_btn" href="#">
								<i class="lnr lnr lnr-heart"></i>
							</a> -->
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!--================End Single Product Area =================-->

	<!--================Product Description Area =================-->
	<!--================End Product Description Area =================-->

	<!--================ Subscription Area ================-->
	<!--================ End Subscription Area ================-->

	<!--================ start footer Area  =================-->
	<footer class="footer-area section_gap">
		<div class="container">
			<!-- footnotes removed -->
			<div class="row footer-bottom d-flex justify-content-between align-items-center">
				<p class="col-lg-12 footer-text text-center"><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
				</p>
			</div>
		</div>
	</footer>
	<!--================ End footer Area  =================-->


	<!-- Optional JavaScript -->
	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/popper.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/stellar.js"></script>
	<script src="vendors/lightbox/simpleLightbox.min.js"></script>
	<script src="vendors/nice-select/js/jquery.nice-select.min.js"></script>
	<script src="vendors/isotope/imagesloaded.pkgd.min.js"></script>
	<script src="vendors/isotope/isotope-min.js"></script>
	<script src="vendors/owl-carousel/owl.carousel.min.js"></script>
	<script src="js/jquery.ajaxchimp.min.js"></script>
	<script src="js/mail-script.js"></script>
	<script src="vendors/jquery-ui/jquery-ui.js"></script>
	<script src="vendors/counter-up/jquery.waypoints.min.js"></script>
	<script src="vendors/counter-up/jquery.counterup.js"></script>
	<script src="js/theme.js"></script>

	<script>
		
		function getQueryVariable(variable) {		
			var query = window.location.search.substring(1);
			var vars = query.split('&');
			for (var i = 0; i < vars.length; i++) {
				var pair = vars[i].split('=');
				if (decodeURIComponent(pair[0]) == variable) {
					return decodeURIComponent(pair[1]);
				}
			}
			console.log('Query variable %s not found', variable);
		}

		var item_id = getQueryVariable("item_id");

		$(document).ready(function(){

			var itemUrl = "https://search-e6998final-iijtdbqlcuarkxq23kyrqvmyii.us-east-1.es.amazonaws.com/item/_doc/" + item_id;

			$.ajax({
				url: itemUrl,
				type: 'GET',
				dataType: 'json',
			}).then(function(data){
				// console.log(data);
				$('#item-description').text(data['_source']['description']);
				$('#pricenum').text(data['_source']['price']);
				$('#item-title').text(data['_source']['title']);
				$('#prvprice').text(data['_source']['prvPrice']);

				var availability = data['_source']['available'];
				if(availability === 1){
					$('#availability').text("In Stock");
				}else{
					$('#availability').text("Unavailable");
				};

				var categories = data['_source']['category'];
				for(var i=0; i<categories.length; i++){
					var newCat = "<span>" + categories[i] + " " + "</span>";
					$('#category').append(newCat);
				};

				var tags = data['_source']['tag'];
				// console.log(tags)
				for(var i=0; i<tags.length; i++){
					var newTag = "<span>" + tags[i] + " " + "</span>";
					// console.log(newTag);
					$('#tag').append(newTag);
				};

				var imgUrls = data['_source']['imageUrl'];
				if((imgUrls.length)>0){
					var elementInd = "<li data-target=\"#carouselExampleIndicators\" data-slide-to=\"0\" class=\"active\"><img src=\"" + imgUrls[0] + "\" width=\"60\" height=\"60\"></li>";
					$('#carousel-ind').append(elementInd);
					var elementInn = "<div class=\"carousel-item active\"><img class=\"d-block w-100\" src=\"" + imgUrls[0] + "\"></div>";
					$('#carousel-inn').append(elementInn);
				}
				for(var i=1; i<imgUrls.length; i++){
					var elementInd = "<li data-target=\"#carouselExampleIndicators\" data-slide-to=\"" + i + "\"><img src=\"" + imgUrls[i] + "\" width=\"60\" height=\"60\"></li>";
					$('#carousel-ind').append(elementInd);
					var elementInn = "<div class=\"carousel-item\"><img class=\"d-block w-100\" src=\"" + imgUrls[i] + "\"></div>";
					$('#carousel-inn').append(elementInn);
				};

			});
			
		});
		
		AccessToken = 'eyJraWQiOiJJT2VcL3p1VXU1SlFaQklkTHlxdmdhdHk2VmpCZjlWT2ZXaWFva0R4dWsyRT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIzYzFkNzkyMS1lYmZkLTRmMjItYTlkMS1iNmM3Mjc1NWY4MWIiLCJldmVudF9pZCI6IjQwODZiYzkzLTg5NDktNDI1MC04ZDExLWNlMGVkMGQ5NmE2MiIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4gcGhvbmUgb3BlbmlkIHByb2ZpbGUgZW1haWwiLCJhdXRoX3RpbWUiOjE1NzY1MzE0MDAsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbVwvdXMtZWFzdC0xX0RITzQ4MXNIayIsImV4cCI6MTU3NjUzNTAwMCwiaWF0IjoxNTc2NTMxNDAwLCJ2ZXJzaW9uIjoyLCJqdGkiOiJjYmY4MjBiNC1iYWE2LTQ4MjQtYTkzOC1hOGU0MmFkNWIyN2MiLCJjbGllbnRfaWQiOiIyZWk3ZGh2cmpocWc3MWt2dHF2ajh1bXZkYSIsInVzZXJuYW1lIjoiM2MxZDc5MjEtZWJmZC00ZjIyLWE5ZDEtYjZjNzI3NTVmODFiIn0.Za174u73hcUWvhj-FvhZccw7pnIIP9NPUkDjFjx4ubvSfcX052iGA6pvJVRjSshfcokonMtZBhWWCS9Kxj-lWsx019QU63VTfCPnDmygjn_JgZT7FcTzfONunL_k0cBmry7vltHGDAjpv3Osw1O6ycRhcGs6wl4aCzZrKg9mwwWSHMCeM-jLkZHAvZPoCHhY0MXAfwe2zkcH3HLwZ32j-QNOngleLxyy-mUqgGuBIi4P7VR1vvZrlWQkniNpCynZTMNjUel0b2M7a7WJ1oPA6xlnoPCPDziziU89Hw8Ix6VK8Ri_K6fRUBtwd8T6PfQFyyUkr0a9NVM23kyYBxI6nA';
		
		// function addCart(){
		// 	$.ajax({			
		// 		type: "PUT",
		// 		url:  "https://api.moreforless.liuqx.net/v1/cart?item=" + item_id,
		// 		crossDomain: true,
		// 		// data: "",
		// 		dataType: "json",
		// 		headers: {"Access-Token": AccessToken},
		// 		success: function(response){
		// 			console.log(response);
		// 			alert("Item Added to Your Cart!");
		// 		},
		// 		error: function(xhr, status, error){
		// 			console.log("error!");
		// 			var errMsg = "Failed." + xhr.responseText + "\n" + status + "\n" + error;
		// 			alert(errMsg);
		// 		}
		// 	});
		// }

		function addCart(){
			$.ajax({			
				type: "PUT",
				url:  "https://api.moreforless.liuqx.net/v1/cart?item=" + item_id,
				// crossDomain: true,
				// data: "",
				// dataType: "json",
				headers: {"Access-Token": AccessToken}
			}).then(function(data){
				alert(data);
				window.open("cart.html");
			})
		}

  </script>

</body>

</html>